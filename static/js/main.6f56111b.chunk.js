(this["webpackJsonpspring-racing"]=this["webpackJsonpspring-racing"]||[]).push([[0],{27:function(e){e.exports=JSON.parse('{"name":"spring-racing","version":"3.1.2","private":true,"homepage":"https://tipping.davidwilliams.ninja","scripts":{"start":"PORT=1818 react-scripts start","build":"react-scripts build","test":"react-scripts test --env=jsdom","eject":"react-scripts eject","predeploy":"npm run build","deploy":"gh-pages -d build"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"dependencies":{"react":"17.0.2","react-dom":"17.0.2","react-fastclick":"^3.0.2","react-router-dom":"^5.3.0","react-scripts":"^4.0.3"},"devDependencies":{"gh-pages":"^3.2.3"}}')},39:function(e,t,s){},40:function(e,t,s){},41:function(e,t,s){"use strict";s.r(t);var a=s(1),n=s.n(a),i=s(23),c=s.n(i),r=s(24),o=s.n(r),l=s(14),d=s.n(l),p=s(18),h=s(6),u=s(13),j=s(2),m=s(3),b=s(17),f=s(5),O=s(4),g=s(12),x=s(7),v=s(0),y=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).state={hasError:!1},a}return Object(m.a)(s,[{key:"componentDidCatch",value:function(e,t){this.setState((function(e){return Object(h.a)(Object(h.a)({},e),{},{hasError:!0})}))}},{key:"render",value:function(){return this.state.hasError?Object(v.jsx)("div",{children:"Sorry, something went wrong."}):this.props.children}}]),s}(a.Component),C=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&window.scrollTo(0,0)}},{key:"render",value:function(){return this.props.children}}]),s}(a.Component),N=Object(x.h)(C);function S(e){e&&e.preventDefault(),localStorage.clear(),window.location.href="/login"}function k(e){e||(e=8);for(var t="1",s="9",a=0;a<e-1;a++)t+="0",s+="0";return Math.floor(parseInt(t)+Math.random()*parseInt(s))}var I=void 0,w=function(e){var t=e.id,s=e.classes,a=e.type,n=e.attributes,i=e.onClick,c=e.disabled,r=e.text;return Object(v.jsx)("button",Object(h.a)(Object(h.a)({id:t,className:s,type:a},n),{},{onClick:i,onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||I.props.onClick(e)},disabled:c,children:r}))},T=function(e){var t,s,n,i=e.competitions,c=e.selectedCompetition,r=e.handleCompetitionSelect,o=Object(a.useRef)(null),l=[],d=[],p=c?c._id:void 0;if(i.length){if(0===i.length)return Object(v.jsxs)("div",{className:"competition-selector",children:[Object(v.jsx)("p",{className:"error",children:"You have not been added to any competitions yet."}),Object(v.jsx)("p",{className:"error",children:"Please talk to a competition admin to be added."})]});if(i.length>5){n=(new Date).getFullYear().toString();for(var h=0,u=i.length;h<u;h++)i[h].startDate.split("-")[0]===n?l.push(Object(v.jsx)("option",{value:i[h]._id,children:i[h].name},i[h]._id)):d.push(Object(v.jsx)("option",{value:i[h]._id,children:i[h].name},i[h]._id));p||(t=Object(v.jsx)("option",{value:"",children:"-- Select Competition --"},"a")),s=Object(v.jsxs)("div",{className:"selector",children:[Object(v.jsxs)("select",{value:p,onChange:r,ref:o,children:[t,Object(v.jsx)("optgroup",{label:"This Years",children:l}),Object(v.jsx)("optgroup",{label:"Previous Years",children:d})]}),Object(v.jsx)("span",{className:"icon-select",onClick:function(){o.current.click()}})]})}else{for(var j,m=[],b=0,f=i.length;b<f;b++)j="link",c&&c._id===i[b]._id&&(j+=" disabled"),m.push(Object(v.jsx)("li",{children:Object(v.jsx)(w,{classes:j,type:"button",attributes:{"data-value":i[b]._id},onClick:r,text:i[b].name})},i[b]._id));s=Object(v.jsx)("ul",{children:m})}return Object(v.jsxs)("div",{className:"competition-selector",children:[Object(v.jsx)("h3",{children:"Please select a competition:"}),s]})}return Object(v.jsx)("div",{})},R=s(27),A=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).handlePicClick=function(){var e=document.documentElement;a.state.open?e.classList.remove("no-scroll"):e.classList.add("no-scroll"),a.setState({open:!a.state.open})},a.handleCompetitionSelect=function(e){a.props.handleCompetitionSelect(e),a.handlePicClick()},a.state={open:!1},a}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"render",value:function(){var e,t,s=this.state.open?"top-menu open":"top-menu",a=(e=this.props.competitions,t=this.props.user,e&&t?e.filter((function(e){return e.punters.includes(t._id)})):[]);return Object(v.jsxs)("div",{className:s,children:[this.props.user&&Object(v.jsxs)("div",{className:"menu-btn-container",onClick:this.handlePicClick,children:[Object(v.jsx)("div",{className:"icon-menu-vertical"}),Object(v.jsx)("span",{className:"icon-arrow-up"})]}),Object(v.jsxs)("div",{className:"column",children:[this.props.isAdmin&&Object(v.jsxs)(g.b,{to:this.props.path+"admin",onClick:this.handlePicClick,children:[Object(v.jsx)("span",{className:"icon-admin"}),"Administration"]}),Object(v.jsxs)(g.b,{to:this.props.path+"information",onClick:this.handlePicClick,children:[Object(v.jsx)("span",{className:"info-icon",children:"i"}),"Information"]}),Object(v.jsxs)("div",{className:"btn-container",children:[Object(v.jsx)(w,{classes:"btn logout",type:"button",onClick:S,disabled:!1,text:"Log Out"}),Object(v.jsxs)("span",{children:["App Version: ",R.version]})]})]}),a.length>1&&Object(v.jsx)("div",{className:"column competition-container",children:Object(v.jsx)(T,{competitions:this.props.competitions,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.handleCompetitionSelect})})]})}}]),s}(a.Component),P=function(e){var t=e.path,s=e.page,a=e.user,n=e.isAdmin,i=e.competitions,c=e.selectedCompetition,r=e.handleCompetitionSelect,o=e.onReloadData,l=e.text;return Object(v.jsxs)(v.Fragment,{children:["Log In"!==s&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(A,{path:t,user:a,competitions:i,selectedCompetition:c,handleCompetitionSelect:r,isAdmin:n}),Object(v.jsx)("img",{className:"profile-pic",src:"pics/"+a.image,alt:"profile-pic",title:"".concat(a.name.first," ").concat(a.name.last)}),Object(v.jsx)("button",{className:"reload-btn",title:"Reload data",onClick:o,children:Object(v.jsx)("span",{className:"icon-reload"})})]}),Object(v.jsxs)("h2",{children:["Spring Racing Tipping ",Object(v.jsx)("img",{src:"horse.png",alt:"Title logo"}),Object(v.jsx)("span",{className:"beta",children:"BETA"})]}),"Log In"!==s&&c&&Object(v.jsx)("span",{className:"comp-name",children:c.name}),Object(v.jsx)("h3",{children:s}),Object(v.jsx)("p",{children:l})]})},D=function(e,t){return t.page===e.page&&e.user&&t.user.name.first===e.user.name.first&&e.user&&t.user.name.last===e.user.name.last&&t.isAdmin===e.isAdmin&&t.competitions.length===e.competitions.length&&t.selectedCompetition.name===e.selectedCompetition.name},_=n.a.memo(P,D),M=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).handleChange=function(e){a.setState({value:e.target.value}),a.props.handleChange(e.target.value)},a.handleFocus=function(e){a.setState({focused:!0})},a.handleBlur=function(e){a.setState({focused:!1})},a.state={value:"",focused:!1},a}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"render",value:function(){var e=k(6),t=this.props.labelClasses||"";return t+=this.state.focused||""!==this.state.value?"label focused":"label",Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("label",{htmlFor:e,className:t,children:this.props.labelText}),Object(v.jsx)("input",{id:e,className:this.props.inputClasses,type:this.props.type,value:this.state.value,onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.props.onKeyDown,disabled:this.props.disabled})]})}}]),s}(a.Component),L=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){var e=k(6);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("label",{htmlFor:e,className:this.props.labelClasses,children:this.props.labelText}),Object(v.jsxs)("div",{className:"selector",children:[Object(v.jsx)("select",{id:e,value:this.props.value,onChange:this.props.handleSelect,disabled:this.props.disabled,children:this.props.options}),Object(v.jsx)("span",{className:"icon-select"})]})]})}}]),s}(a.PureComponent),E=function(e){var t=e.classes,s=e.text;return Object(v.jsx)("div",{className:t,children:s})},U=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).handlePunterSelect=function(e){a.setState({user:parseInt(e.target.value,10),wrongPassword:!1})},a.handlePasswordChange=function(e){a.setState({password:e,wrongPassword:!1})},a.handleLoginClick=function(){var e=a.props.allPunters.find((function(e){return e._id===a.state.user}));e&&(e.password===a.state.password?(a.setState({wrongPassword:!1}),a.props.handleLogin(a.state.user)):a.setState({wrongPassword:!0}))},a.handleCompetitionSelect=function(e){a.props.handleCompetitionSelect(e),a.props.history.push("/results")},a.state={user:null,password:"",wrongPassword:!1,punterComps:[]},a}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"render",value:function(){for(var e=this,t=this.props.allPunters.sort((function(e,t){return e.name.first.localeCompare(t.name.first)})),s=0,a=t.length;s<a;s++)"Top"!==t[s].name.first&&"Bottom"!==t[s].name.first&&"1, 2, 3"!==t[s].name.first||t.push(t.splice(s,1)[0]);var n=t.map((function(e){return Object(v.jsxs)("option",{value:e._id,children:[e.name.first," ",e.name.last]},e._id)}));n.unshift(Object(v.jsx)("option",{value:"",children:"-- Select Name --"},"a"));var i=this.state.wrongPassword?"error":"error hide";return Object(v.jsxs)("div",{className:"app login-page",children:[Object(v.jsx)(_,{page:"Log In",competitions:this.props.competitions,user:this.props.user,isAdmin:this.props.isAdmin,text:"Please select your name from the drop down, and then enter your password to log in."}),Object(v.jsxs)("form",{onSubmit:this.props.user?function(e){return S(e)}:this.handleLoginClick,children:[Object(v.jsx)(L,{labelClasses:"sr-only",labelText:"Select a punter",value:this.props.user?this.props.user._id:this.state.user?this.state.user:"",handleSelect:this.handlePunterSelect,disabled:this.props.user,options:n}),!this.props.user&&Object(v.jsx)(M,{labelText:"Password",inputClasses:"password",type:"password",value:this.props.user?this.props.user.password:"",handleChange:this.handlePasswordChange,onKeyDown:function(t){"Enter"!==t.code&&"NumpadEnter"!==t.code||e.handleLoginClick(t)},disabled:this.props.user}),Object(v.jsx)(w,{classes:"btn",type:"submit",disabled:!1,text:this.props.user?"Log Out":"Log In"}),Object(v.jsx)(E,{classes:i,text:"The password for the name you selected is incorrect"}),this.props.user&&this.props.competitions.length&&Object(v.jsx)(T,{competitions:this.props.competitions,handleCompetitionSelect:this.handleCompetitionSelect})]})]})}}]),s}(a.Component),F=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){var e,t,s=this.props.meets.sort((function(e,t){return e.date.localeCompare(t.date)}));return s&&this.props.selectedMeetId?Object(v.jsxs)("div",{className:"selector",children:[Object(v.jsx)("select",{value:this.props.selectedMeetId,onChange:this.props.onChange,children:s.map((function(s){return e=s.date.split("-"),t="".concat(e[2],"/").concat(e[1]),Object(v.jsxs)("option",{value:s._id,children:[s.name," (",t,")"]},s._id)}))}),Object(v.jsx)("span",{className:"icon-select"})]}):Object(v.jsx)("div",{})}}]),s}(a.Component),q=function(e){var t=e.path;return Object(v.jsxs)("div",{className:"bottom-menu",children:[Object(v.jsxs)(g.b,{to:t+"statistics",activeClassName:"selected",children:[Object(v.jsx)("div",{className:"icon icon-pie-chart"}),"Statistics"]}),Object(v.jsxs)(g.b,{to:t+"tips",activeClassName:"selected",children:[Object(v.jsx)("div",{className:"icon icon-pencil"}),"Tips"]}),Object(v.jsxs)(g.b,{to:t+"results",activeClassName:"selected",children:[Object(v.jsx)("div",{className:"icon icon-clipboard"}),"Results"]}),Object(v.jsxs)(g.b,{to:t+"leaderboard",activeClassName:"selected",children:[Object(v.jsx)("div",{className:"icon icon-leader-board"}),"Leaderboard"]})]})},J=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).setStateData=function(e,t){var s=a.state.races,n=e.filter((function(e){return e.meetId===t}));n&&n.sort((function(e,t){return e.number-t.number}));for(var i=0,c=n.length;i<c;i++)s[i].placings=n[i].placings,s[i].scratchings=n[i].scratchings;a.setState({races:s})},a.handlePlacingChange=function(e){var t,s=e.target.value,n=Object(u.a)(a.state.races),i=e.target.id.split("-")[1],c=e.target.id.split("-")[2],r=n[i-1].placings;t=s.indexOf(",")>-1?s.replace(", 0","").replace(",0",""):Number.isNaN(parseInt(s))?0:parseInt(s),"first"===c&&(r.first=t),"second"===c&&(r.second=t),"third"===c&&(r.third=t),a.setState({races:n})},a.handleSaveClick=function(e){var t=function(e){return e.replace(" ","").split(",").reduce((function(e,t){return"0"===t||Number.isNaN(parseInt(t))||e.push(parseInt(t)),e}),[])},s=a.state.races[e.target.getAttribute("data-race")-1].placings;s.first.constructor===String&&s.first.indexOf(",")>-1&&(s.first=t(s.first)),s.second.constructor===String&&s.second.indexOf(",")>-1&&(s.second=t(s.second)),s.third.constructor===String&&s.third.indexOf(",")>-1&&(s.third=t(s.third)),a.props.onPlacingsChange(parseInt(e.target.getAttribute("data-race-id")),s)},a.handleScratchingClick=function(e){var t=a.state.races,s=parseInt(e.target.getAttribute("data-race"),10)-1,n=t[s].scratchings;if(e.target.classList.contains("scratched")){var i=n.indexOf(parseInt(e.target.innerText,10));i>-1&&n.splice(i,1)}else n.push(parseInt(e.target.innerText,10));t[s].scratchings=n,a.setState({races:t}),a.props.onScratchingChange(parseInt(e.target.getAttribute("data-race-id"),10),n)},a.state={races:[{number:1,placings:{first:"",second:"",third:""},scratchings:[]},{number:2,placings:{first:"",second:"",third:""},scratchings:[]},{number:3,placings:{first:"",second:"",third:""},scratchings:[]},{number:4,placings:{first:"",second:"",third:""},scratchings:[]},{number:5,placings:{first:"",second:"",third:""},scratchings:[]},{number:6,placings:{first:"",second:"",third:""},scratchings:[]},{number:7,placings:{first:"",second:"",third:""},scratchings:[]},{number:8,placings:{first:"",second:"",third:""},scratchings:[]},{number:9,placings:{first:"",second:"",third:""},scratchings:[]},{number:10,placings:{first:"",second:"",third:""},scratchings:[]},{number:11,placings:{first:"",second:"",third:""},scratchings:[]}]},a}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"componentDidMount",value:function(){this.setStateData(this.props.races,this.props.selectedMeet)}},{key:"componentDidUpdate",value:function(e){this.props!==e&&this.setStateData(this.props.races,this.props.selectedMeet)}},{key:"render",value:function(){var e,t=this,s=this.props.races.filter((function(e){return e.meetId===t.props.selectedMeet})),a=[],n=[];s&&s.sort((function(e,t){return e.number-t.number}));for(var i=0,c=s.length;i<c;i++){n=[];for(var r=0;r<24;r++)e="selection",this.state.races[i].scratchings.includes(r+1)&&(e+=" scratched"),n.push(Object(v.jsx)("div",{className:e,"data-race":i+1,"data-race-id":s[i]._id,onClick:this.handleScratchingClick,children:r+1},r));var o=0!==this.state.races[i].placings.first?this.state.races[i].placings.first:"",l=0!==this.state.races[i].placings.second?this.state.races[i].placings.second:"",d=0!==this.state.races[i].placings.third?this.state.races[i].placings.third:"";o.constructor===Array&&(o=o.join(", ")),l.constructor===Array&&(l=l.join(", ")),d.constructor===Array&&(d=d.join(", ")),a.push(Object(v.jsxs)("div",{className:"adminRace",children:[Object(v.jsxs)("div",{className:"details",children:[Object(v.jsxs)("span",{className:"bold",children:["RACE ",s[i].number]}),Object(v.jsxs)("span",{className:"name",children:["\xa0-\xa0",s[i].name]})]}),Object(v.jsxs)("div",{className:"placings-container",children:[Object(v.jsxs)("div",{className:"placings",children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"race-"+(i+1)+"-first",children:"1st"}),Object(v.jsx)("input",{id:"race-"+(i+1)+"-first",type:"tel",value:o,onChange:this.handlePlacingChange})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"race-"+(i+1)+"-second",children:"2nd"}),Object(v.jsx)("input",{id:"race-"+(i+1)+"-second",type:"tel",value:l,onChange:this.handlePlacingChange})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"race-"+(i+1)+"-third",children:"3rd"}),Object(v.jsx)("input",{id:"race-"+(i+1)+"-third",type:"tel",value:d,onChange:this.handlePlacingChange})]})]}),Object(v.jsx)("button",{className:"save-btn",type:"button","data-race":i+1,"data-race-id":s[i]._id,onClick:this.handleSaveClick,children:"Save"})]}),Object(v.jsx)("div",{className:"dead-heat-msg",children:"For dead heats, just enter each number seperated by a comma eg. 1, 2."}),Object(v.jsx)("div",{className:"mb-10 bold",children:"Set Race Status"}),Object(v.jsxs)("div",{className:"status-selector",children:[Object(v.jsx)(w,{classes:1===s[i].status?"btn status-selector-btn selected":"btn status-selector-btn",type:"button",attributes:{"data-meet":this.props.selectedMeet,"data-race":i+1,"data-race-id":s[i]._id,"data-status":1},onClick:this.props.onStatusChange,text:"Not Run Yet"}),Object(v.jsx)(w,{classes:2===s[i].status?"btn status-selector-btn selected":"btn status-selector-btn",type:"button",attributes:{"data-meet":this.props.selectedMeet,"data-race":i+1,"data-race-id":s[i]._id,"data-status":2},onClick:this.props.onStatusChange,text:"About To Jump"}),Object(v.jsx)(w,{classes:3===s[i].status?"btn status-selector-btn selected":"btn status-selector-btn",type:"button",attributes:{"data-meet":this.props.selectedMeet,"data-race":i+1,"data-race-id":s[i]._id,"data-status":3},onClick:this.props.onStatusChange,text:"Racing"}),Object(v.jsx)(w,{classes:4===s[i].status?"btn status-selector-btn selected":"btn status-selector-btn",type:"button",attributes:{"data-meet":this.props.selectedMeet,"data-race":i+1,"data-race-id":s[i]._id,"data-status":4},onClick:this.props.onStatusChange,text:"Has Run"})]}),Object(v.jsxs)("div",{className:"scratching-list",children:[Object(v.jsx)("div",{className:"mb-10 bold",children:"Scratchings"}),Object(v.jsx)("div",{className:"selections",children:n})]})]},i))}return Object(v.jsxs)("div",{className:"app",children:[Object(v.jsx)(_,{page:"Administration",path:this.props.path,competitions:this.props.competitions,user:this.props.user,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.props.handleCompetitionSelect,onReloadData:this.props.onReloadData,isAdmin:this.props.isAdmin,text:"This is the Administration page used to set placings, race statuses and scratchings."}),Object(v.jsx)(F,{meets:this.props.meets,selectedMeetId:this.props.selectedMeet,onChange:this.props.onMeetChange}),Object(v.jsx)("div",{className:"adminRaceList",children:a}),Object(v.jsx)(q,{path:this.props.path})]})}}]),s}(a.Component),H=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var n;return Object(j.a)(this,s),(n=t.call(this,e)).handleTabClick=function(e){var t=1;e.target.classList.contains("two")&&(t=2),n.setState({tabSelected:t}),n.props.onTabSelect(t)},n.findTips=function(e,t){return n.props.tips.find((function(s){return s.punterId===e&&s.raceId===t}))},n.findPunter=function(e){return n.props.punters.find((function(t){return t._id===e}))},n.findPuntersStats=function(e,t){return e.find((function(e){return e.punterId===t}))},n.findPuntersStatsMeet=function(e,t){return e.meets.find((function(e){return e.meetId===t}))},n.calculateStats=function(){for(var e,t,s,a,i,c,r,o,l=[],d=[],p=0,u=0,j=0,m=n.props.meets.length,b=n.props.punters.length;m--;)d.push({meetId:n.props.meets[m]._id,date:n.props.meets[m].date,score:0});for(d.sort((function(e,t){return Date.parse(e.date)-Date.parse(t.date)}));b--;)l.push({punterId:n.props.punters[b]._id,trifectas:0,quinellas:0,firsts:0,seconds:0,thirds:0,meets:d.map((function(e){return Object(h.a)({},e)}))});for(b=n.props.punters.length;b--;)for(e=n.props.races.length;e--;)if(a=n.props.races[e].placings,i=n.findTips(n.props.punters[b]._id,n.props.races[e]._id)){if(o=p=u=j=0,c=n.findPuntersStats(l,n.props.punters[b]._id),r=n.findPuntersStatsMeet(c,n.props.races[e].meetId),a.first.constructor===Array)for(t=0,s=a.first.length;t<s;t++)i.selections.includes(a.first[t])&&(o+=3,c.firsts++,p++);else i.selections.includes(a.first)&&(o+=3,c.firsts++,p++);if(a.second.constructor===Array)for(t=0,s=a.second.length;t<s;t++)i.selections.includes(a.second[t])&&(o+=2,c.seconds++,u++);else i.selections.includes(a.second)&&(o+=2,c.seconds++,u++);if(a.third.constructor===Array)for(t=0,s=a.third.length;t<s;t++)i.selections.includes(a.third[t])&&(o+=1,c.thirds++,j++);else i.selections.includes(a.third)&&(o+=1,c.thirds++,j++);(1===p&&1===u&&1===j||2===p&&1===u||1===p&&2===u)&&c.trifectas++,(1===p&&1===u&&0===j||2===p&&0===u)&&c.quinellas++,r.score+=o}return l},n.createStatArray=function(e,t,s){var i,c,r,o=[],l=[],d=[],p=[],h=[],u=[],j=0;if(s)for(var m=0,b=e.length;m<b;m++){e[m].scores.sort((function(e,t){return t.score-e.score}));for(var f=0,O=e[m].scores.length;f<O;f++)i=n.findPunter(e[m].scores[f].punterId),c=f+1!==11&&(f+1)%10===1?"<sup>ST</sup>":f+1!==12&&(f+1)%10===2?"<sup>ND</sup>":f+1!==13&&(f+1)%10===3?"<sup>RD</sup>":"<sup>TH</sup>",o.push(Object(v.jsxs)("div",{className:"stat-item",children:[Object(v.jsx)("div",{className:"number",dangerouslySetInnerHTML:{__html:f+1+c}}),Object(v.jsx)("img",{src:"pics/"+i.image,alt:"Profile pic",className:"pic"}),Object(v.jsx)("div",{className:"name",children:i.name.display}),Object(v.jsx)("div",{className:"stat",children:e[m].scores[f].score})]},f));t.push(Object(v.jsxs)(a.Fragment,{children:[Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"bold mt-20 mb-10",children:e[m].name}),Object(v.jsx)("div",{className:"stat-container",children:o})]},m)),o=[]}else{for(;j<5;){0===j?(o=l,r="trifectas",e.sort((function(e,t){return t.trifectas-e.trifectas}))):1===j?(o=d,r="quinellas",e.sort((function(e,t){return t.quinellas-e.quinellas}))):2===j?(o=p,r="firsts",e.sort((function(e,t){return t.firsts-e.firsts}))):3===j?(o=h,r="seconds",e.sort((function(e,t){return t.seconds-e.seconds}))):(o=u,r="thirds",e.sort((function(e,t){return t.thirds-e.thirds})));for(var g=0,x=e.length;g<x;g++)i=n.findPunter(e[g].punterId),c=g+1!==11&&(g+1)%10===1?"<sup>ST</sup>":g+1!==12&&(g+1)%10===2?"<sup>ND</sup>":g+1!==13&&(g+1)%10===3?"<sup>RD</sup>":"<sup>TH</sup>",o.push(Object(v.jsxs)("div",{className:"stat-item",children:[Object(v.jsx)("div",{className:"number",dangerouslySetInnerHTML:{__html:g+1+c}}),Object(v.jsx)("img",{src:"pics/"+i.image,alt:"Profile pic",className:"pic"}),Object(v.jsx)("div",{className:"name",children:i.name.display}),Object(v.jsx)("div",{className:"stat",children:e[g][r]})]},"".concat(j).concat(g)));j++}t.push(Object(v.jsxs)(a.Fragment,{children:[Object(v.jsx)("div",{className:"bold mt-20 mb-10",children:"Trifectas"}),Object(v.jsx)("div",{className:"stat-container",children:l}),Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"bold mt-20 mb-10",children:"Quinellas"}),Object(v.jsx)("div",{className:"stat-container",children:d}),Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"bold mt-20 mb-10",children:"Firsts"}),Object(v.jsx)("div",{className:"stat-container",children:p}),Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"bold mt-20 mb-10",children:"Seconds"}),Object(v.jsx)("div",{className:"stat-container",children:h}),Object(v.jsx)("hr",{}),Object(v.jsx)("div",{className:"bold mt-20 mb-10",children:"Thirds"}),Object(v.jsx)("div",{className:"stat-container",children:u})]},"a"))}},n.state={tabSelected:1},n}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"componentDidMount",value:function(){this.state.tabSelected!==this.props.selectedTab&&this.setState({tabSelected:this.props.selectedTab})}},{key:"render",value:function(){var e,t,s,a,n=this.calculateStats(),i=[],c=[],r=[];1===this.state.tabSelected?(e="btn tab-btn one selected",t="btn tab-btn two",s="tab-panel",a="tab-panel hide"):(e="btn tab-btn one",t="btn tab-btn two selected",s="tab-panel hide",a="tab-panel");var o=Object(u.a)(this.props.meets);o.sort((function(e,t){return Date.parse(e.date)-Date.parse(t.date)}));for(var l=0,d=o.length;l<d;l++)i.push({meetId:o[l]._id,name:o[l].name,scores:[]});for(var p=function(e,t){for(var s=function(t,s){i.find((function(s){return s.meetId===n[e].meets[t].meetId})).scores.push({punterId:n[e].punterId,score:n[e].meets[t].score})},a=0,c=n[e].meets.length;a<c;a++)s(a)},h=0,j=n.length;h<j;h++)p(h);return this.createStatArray(i,c,!0),this.createStatArray(n,r,!1),Object(v.jsxs)("div",{className:"app",children:[Object(v.jsx)(_,{page:"Statistics",competitions:this.props.competitions,path:this.props.path,user:this.props.user,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.props.handleCompetitionSelect,onReloadData:this.props.onReloadData,isAdmin:this.props.isAdmin,text:"Here you can find various statistics, such as the placings for each race meet, number of trifectas, quinellas, 1sts, 2nds, 3rds, etc."}),Object(v.jsxs)("div",{className:"tab-btns",children:[Object(v.jsx)("button",{className:e,onClick:this.handleTabClick,children:"Meet Scores"}),Object(v.jsx)("button",{className:t,onClick:this.handleTabClick,children:"Other"})]}),Object(v.jsx)("div",{className:s,children:c}),Object(v.jsx)("div",{className:a,children:r}),Object(v.jsx)(q,{path:this.props.path})]})}}]),s}(a.Component),B=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"render",value:function(){return Object(v.jsxs)("div",{className:"app",children:[Object(v.jsx)(_,{page:"Information",path:this.props.path,competitions:this.props.competitions,user:this.props.user,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.props.handleCompetitionSelect,onReloadData:this.props.onReloadData,isAdmin:this.props.isAdmin,text:"This is where you can find a run down of how each of the pages of this app work, as well as the browser support and what some of the ideas for the future are."}),Object(v.jsx)("div",{className:"bold mt-20",children:"Browser Support"}),Object(v.jsx)("p",{children:"While this app will work fine on tablets and desktop, it was designed for mobile screen size, and to run in the latest version of the following browsers:"}),Object(v.jsxs)("ul",{className:"browser-list",children:[Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"browser chrome"}),"Chrome"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"browser safari"}),"Safari"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"browser firefox"}),"Firefox"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"browser opera"}),"Opera"]})]}),Object(v.jsx)("div",{className:"bold mt-20",children:"Game Accounts"}),Object(v.jsx)("p",{children:"There are three game accounts which appear in lists like regular people (excluding the leaderboard).  These three accounts are:"}),Object(v.jsxs)("div",{className:"game-account-totals",children:[Object(v.jsxs)("div",{className:"total",children:[Object(v.jsx)("img",{src:"pics/Game.png",alt:"Profile pic",className:"pic"}),Object(v.jsx)("div",{className:"name",children:"Top Odds"})]}),Object(v.jsxs)("div",{className:"total",children:[Object(v.jsx)("img",{src:"pics/Game.png",alt:"Profile pic",className:"pic"}),Object(v.jsx)("div",{className:"name",children:"Bottom Odds"})]}),Object(v.jsxs)("div",{className:"total",children:[Object(v.jsx)("img",{src:"pics/Game.png",alt:"Profile pic",className:"pic"}),Object(v.jsx)("div",{className:"name",children:"Leigh's Algorithm"})]})]}),Object(v.jsx)("p",{children:"Top Odds = Always picks the horses with the top three odds. Decided on form if more than one horse have the same odds."}),Object(v.jsx)("p",{children:"Bottom Odds = Always picks the horses with the bottom three odds. Decided on form if more than one horse have the same odds."}),Object(v.jsx)("p",{children:"Leigh's Algorithm is the results of Leigh Sullivan's attempts to create an algorithm that can predict the winners."}),Object(v.jsx)("div",{className:"bold mt-20",children:"Tips"}),Object(v.jsx)("p",{children:"On the Tips page you can select a race meet from the drop down menu to view the list of races and their associated tips. You can submit 3 tips for each race of every race meet.  If you have selected 3 horses already, but want to change a selection, then you will have to unselect a horse before you can select a new one.  If you select less than 3 horses, then you simply miss out on the opprtunity to get those points."}),Object(v.jsx)("p",{children:"To select or unselect a number, you must double-click/double-tap on it.  This is to help prevent people accidently selecting or unselecting things while they are just scrolling the page."}),Object(v.jsx)("p",{children:"The tips for each race meet must be submitted by 10:00am AEDT on the day of the race meet."}),Object(v.jsx)("p",{children:"The tips for all the races of a race meet will be disabled after 10:00am on the day of the meet."}),Object(v.jsx)("div",{className:"bold mt-20",children:"Results"}),Object(v.jsx)("p",{children:"On the Results page you can select a race meet to view the races for that meet, and the associated details and each punters tips for each race."}),"The races appear as coloured circles below the race meet drop down.  The selected race has a tapered bottom.  The colours match the status of the race:",Object(v.jsxs)("ul",{children:[Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"demo-square bg-blue"})," Not Yet Run"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"demo-square bg-orange"})," About To Jump"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"demo-square bg-red"})," Racing"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("span",{className:"demo-square bg-green"})," Has Run"]})]}),Object(v.jsx)("p",{children:"5 minutes before a race is due to run its status will automatically change to 'About To Jump'.  An admin will then have to manually set it to 'Racing' and 'Has Run' on the Admin page, as they can tend to run late."}),Object(v.jsx)("p",{children:"When you select a race you can see its details and placings appear, and below that will be a list of everybody's tips for that race.  Each person's tips shows each of their 3 picks and the calculated score.  Any correct tips will be shown in teal with a tick next to it."}),Object(v.jsx)("div",{className:"bold mt-20",children:"Leaderboard"}),Object(v.jsx)("p",{children:"On the Leaderboard page you can see the current rank of all the punters.  The rank is determined first by people's overall score, then how many trifectas (first, second, third) they have, then how many quinellas (first, second) they have, then by number of first places, then finally second places."}),Object(v.jsx)("p",{children:"The top three will appear on the podium, everybody else will be listed in order under 'Best of the Rest'."}),Object(v.jsx)("div",{className:"bold mt-20",children:"Admin"}),Object(v.jsxs)("p",{children:["Anybody who is marked as an admin will see an Administration link ",Object(v.jsx)("span",{className:"icon-admin demo"})," appear in the menu, above the Information link ",Object(v.jsx)("span",{className:"icon-info demo"})]}),Object(v.jsx)("p",{children:"When you click the admin link it will take you to the Admin page.  Currently on the Admin page you can set the placings, status and scratchings for each race."}),Object(v.jsx)("p",{children:"In the future I'd like to add more functionality here, like for example the ability to disable people from getting points, etc."}),Object(v.jsx)("div",{className:"bold mt-20",children:"Future Plans"}),Object(v.jsxs)("ul",{className:"marked-list",children:[Object(v.jsx)("li",{children:"People can create accounts and it has proper authentication."}),Object(v.jsx)("li",{children:"Use a service worker to allow people to pin the page to their Home screens with an icon, and cache all the files so that the page will start up instantly like a native app."}),Object(v.jsxs)("li",{children:["Make a different version of the same app, but introduce some game-type elements.  So it would be more for fun than serious tipping.  It could also be modified to be for the greyhounds.",Object(v.jsx)("br",{}),"Ideas for the game elements are:",Object(v.jsxs)("ul",{children:[Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"7 x Carrots (1 per meet probably)"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," Makes a horse surge home at the finish."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Earn points for one place higher than it actually finishes. Wasted if the horse comes in 1st, or 5th or below."]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"2 x Purple Carrots"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," More nutritious than regular carrots."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Earn points for two places higher. Wasted if the horse comes in 1st, or 6th or below. If it comes in 2nd then get the points for 1st, same as a regular carrot"]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"1 x Juiced Syringe"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," Turn your nags into the Lance Armstrong of horses."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Get double points for a whole race meet."]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"1 x Poisioned Syringe"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," 'Phar Lap' a horse."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Kill a horse so nobody can get points for it for that race. Perhaps could be a bonus that is awarded to the person who wins the second meet or something, so then it is limited to only being used once by one person, but affects everyone equally?"]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"1 x Shank"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," 'Monica Seles' a jockey."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Shank a jockey so nobody can get points for them for that race meet. Perhaps could be a bonus that is awarded to the person that wins the first meet or something, so then it is limited to only being used once by one person, but affects everyone equally?"]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"7 x Glue Sticks (1 per meet probably)"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," Get out of a sticky situation."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," If any of the horses you pick come last, send them to the glue factory to earn 1 point."]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"1 x Ricky Bobby"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," If you ain't first, your last."]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Pick a horse to put everything on (only one tip for that race).  If it comes first you get double points (6).  If it comes anything else you get nothing."]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"? x Sugar Cubes"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," ?"]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Something good?"]})]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("div",{children:"? x Riding Crops"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Tag line:"})," ?"]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:"Explaination:"})," Something good or bad?"]})]})]})]})]}),Object(v.jsx)("p",{children:"If you come across any issues, or you have any ideas for things to add or improve, let me know via Facebook Messager or email - sanmerah@gmail.com"}),Object(v.jsx)(q,{path:this.props.path})]})}}]),s}(a.PureComponent),Y=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).setTips=function(e){for(var t=e.races.length,s=[{raceId:null,number:1,databaseId:null,selections:[]},{raceId:null,number:2,databaseId:null,selections:[]},{raceId:null,number:3,databaseId:null,selections:[]},{raceId:null,number:4,databaseId:null,selections:[]},{raceId:null,number:5,databaseId:null,selections:[]},{raceId:null,number:6,databaseId:null,selections:[]},{raceId:null,number:7,databaseId:null,selections:[]},{raceId:null,number:8,databaseId:null,selections:[]},{raceId:null,number:9,databaseId:null,selections:[]},{raceId:null,number:10,databaseId:null,selections:[]},{raceId:null,number:11,databaseId:null,selections:[]}],n=0,i=0,c=e.tips.length;i<c&&n!==t;i++)if(e.tips[i].punterId===e.user._id){for(var r=0;r<t;r++)if(e.races[r]._id===e.tips[i].raceId){s[e.races[r].number-1]={raceId:e.races[r]._id,number:e.races[r].number,databaseId:e.tips[i]._id,selections:e.tips[i].selections};break}n++}a.setState({tips:s})},a.handleSelectionClick=function(e){var t=a.state.tips,s=parseInt(e.target.getAttribute("data-race-no"),10),n=t.find((function(e){return e.number===s})),i=t.indexOf(n);e.target.classList.contains("selected")?((i=n.selections.indexOf(parseInt(e.target.innerText)))>-1&&n.selections.splice(i,1),a.setState({tips:t}),a.props.onSelectionChange(n)):n.selections.length<3&&(n.selections.push(parseInt(e.target.innerText)),t[i]=n,a.setState({tips:t}),a.props.onSelectionChange(n))},a.generateList=function(){for(var e,t,s,n=[],i=[],c=0,r=a.props.races.length;c<r;c++){for(i=[],s=0;s<24;s++)e="selection",a.props.races[c].scratchings.includes(s+1)&&(e+=" scratched"),a.state.tips[c].selections.includes(s+1)&&(e+=" selected"),i.push(Object(v.jsx)("div",{className:e,"data-race-no":c+1,onClick:a.handleSelectionClick,children:s+1},s));t=!0===a.props.savedRaces["race".concat(a.props.races[c].number)]?Object(v.jsx)("span",{className:"saved-status",children:"Tips completed"}):"",n.push(Object(v.jsxs)("div",{className:"tip-group",children:[Object(v.jsxs)("div",{className:"details",children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)("span",{className:"bold",children:["RACE ",a.props.races[c].number]}),t]}),Object(v.jsx)("span",{children:a.props.races[c].time}),Object(v.jsxs)("span",{className:"name",children:["\xa0-\xa0",a.props.races[c].name]})]}),Object(v.jsx)("div",{className:"selections",children:i})]},c))}return n},a.hasntEnteredAllTips=function(){for(var e=0,t=a.props.races.length;e<t;e++)if(!1===a.props.savedRaces["race".concat(a.props.races[e].number)])return!0;return!1},a.state={tips:[{raceId:null,number:1,databaseId:null,selections:[]},{raceId:null,number:2,databaseId:null,selections:[]},{raceId:null,number:3,databaseId:null,selections:[]},{raceId:null,number:4,databaseId:null,selections:[]},{raceId:null,number:5,databaseId:null,selections:[]},{raceId:null,number:6,databaseId:null,selections:[]},{raceId:null,number:7,databaseId:null,selections:[]},{raceId:null,number:8,databaseId:null,selections:[]},{raceId:null,number:9,databaseId:null,selections:[]},{raceId:null,number:10,databaseId:null,selections:[]},{raceId:null,number:11,databaseId:null,selections:[]}]},a}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props&&t===this.state)}},{key:"componentDidMount",value:function(){this.setTips(this.props)}},{key:"componentDidUpdate",value:function(e){this.props!==e&&this.setTips(this.props)}},{key:"render",value:function(){var e,t=this.generateList(),s=this.props.meet?new Date(this.props.meet.date):new Date;return s.setHours(10),s.setMinutes(15),e=new Date>s?"raceList disabled":"raceList",Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(x.a,{when:this.hasntEnteredAllTips(),message:"You have not yet entered all your tips for this meet, are you sure you want to leave the Tips page?"}),Object(v.jsx)("div",{className:e,children:t})]})}}]),s}(a.Component),G=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){var e=this,t=this.props.meets.find((function(t){return t._id===e.props.selectedMeet})),s=this.props.races.filter((function(t){return t.meetId===e.props.selectedMeet})),a=this.props.tips.filter((function(t){return t.meetId===e.props.selectedMeet}));return s&&s.sort((function(e,t){return e.number-t.number})),Object(v.jsxs)("div",{className:"app",children:[Object(v.jsx)(_,{page:"Tips",path:this.props.path,competitions:this.props.competitions,user:this.props.user,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.props.handleCompetitionSelect,onReloadData:this.props.onReloadData,isAdmin:this.props.isAdmin,text:"You want a tip?.....be good to your mother.  Otherwise, simply select 3 horses for each race.  If you already have 3 selected and want to change one, simply unselect one of them. Don't worry about saving at the end, your tips are saved every time you make a change."}),Object(v.jsx)("p",{children:Object(v.jsx)("b",{children:"* Tips must be in by 10:00am AEDT on race day."})}),Object(v.jsx)("p",{children:"The tips will be disabled after this time."}),Object(v.jsx)(F,{meets:this.props.meets,selectedMeetId:this.props.selectedMeet,onChange:this.props.onMeetChange}),Object(v.jsxs)("div",{className:"tip-examples",children:[Object(v.jsx)("span",{className:"selection selected",children:"18"}),Object(v.jsx)("span",{children:"Selected"}),Object(v.jsx)("span",{className:"selection scratched",children:"18"}),Object(v.jsx)("span",{children:"Scratched"}),Object(v.jsx)("span",{className:"selection selected scratched",children:"18"}),Object(v.jsx)("span",{children:"Both"})]}),Object(v.jsx)(Y,{meet:t,races:s,tips:a,selectedRace:this.props.selectedRace,savedRaces:this.props.savedRaces,user:this.props.user,onSelectionChange:this.props.onSelectionChange}),Object(v.jsx)(q,{path:this.props.path})]})}}]),s}(a.Component),W=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){var e,t,s,a,n=this,i=this,c=this.props.punters.find((function(e){return e._id===i.props.tips.punterId})),r=this.props.meets.find((function(e){return e._id===n.props.selectedMeetId})),o=r?new Date(r.date):new Date,l=!1,d=0,p="",h="",u="",j="";if(o.setHours(10),o.setMinutes(15),new Date>o&&(l=!0),c===i.props.user||l){var m=function(e){0===e&&(p="correct"),1===e&&(h="correct"),2===e&&(u="correct")};if(i.props.placings.first.constructor===Array)for(var b=0,f=i.props.placings.first.length;b<f;b++)(e=i.props.tips.selections.indexOf(i.props.placings.first[b]))>-1&&(d+=3,m(e));else(e=i.props.tips.selections.indexOf(i.props.placings.first))>-1&&(d+=3,m(e));if(i.props.placings.second.constructor===Array)for(var O=0,g=i.props.placings.second.length;O<g;O++)(e=i.props.tips.selections.indexOf(i.props.placings.second[O]))>-1&&(d+=2,m(e));else(e=i.props.tips.selections.indexOf(i.props.placings.second))>-1&&(d+=2,m(e));if(i.props.placings.third.constructor===Array)for(var x=0,y=i.props.placings.third.length;x<y;x++)(e=i.props.tips.selections.indexOf(i.props.placings.third[x]))>-1&&(d++,m(e));else(e=i.props.tips.selections.indexOf(i.props.placings.third))>-1&&(d++,m(e));t=i.props.tips.selections[0],s=i.props.tips.selections[1],a=i.props.tips.selections[2],d>=6&&(j="perfect animate")}else t=i.props.tips.selections[0]?Object(v.jsx)("span",{className:"question-mark",children:"?"}):"",s=i.props.tips.selections[1]?Object(v.jsx)("span",{className:"question-mark",children:"?"}):"",a=i.props.tips.selections[2]?Object(v.jsx)("span",{className:"question-mark",children:"?"}):"";return Object(v.jsxs)("div",{className:"tip",children:[Object(v.jsx)("img",{src:"pics/"+c.image,alt:"Profile pic",className:"pic"}),Object(v.jsxs)("span",{className:"name",children:[c.name.first," ",c.name.last]}),Object(v.jsxs)("div",{className:"numbers",children:[Object(v.jsxs)("div",{className:"group",children:[Object(v.jsx)("span",{className:"label",children:"Pick 1"}),"\xa0-\xa0",Object(v.jsx)("span",{className:p,children:t})]}),Object(v.jsxs)("div",{className:"group",children:[Object(v.jsx)("span",{className:"label",children:"Pick 2"}),"\xa0-\xa0",Object(v.jsx)("span",{className:h,children:s})]}),Object(v.jsxs)("div",{className:"group",children:[Object(v.jsx)("span",{className:"label",children:"Pick 3"}),"\xa0-\xa0",Object(v.jsx)("span",{className:u,children:a})]})]}),Object(v.jsxs)("div",{className:"score",children:[Object(v.jsx)("div",{className:"heading",children:"Score"}),Object(v.jsx)("div",{className:j,children:d})]})]})}}]),s}(a.Component),K=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){var e,t,s=this,a=this,n=a.props.tips.map((function(e){return Object(v.jsx)(W,{tips:e,meets:a.props.meets,selectedMeetId:s.props.selectedMeetId,punters:a.props.punters,user:a.props.user,placings:a.props.race.placings},e._id)}));switch(n.length||n.push(Object(v.jsx)("div",{className:"no-races-msg",children:"There are not yet any tips for this race."},"a")),a.props.race.status){case 1:e="status blue",t="Not Yet Run";break;case 2:e="status orange",t="About To Jump";break;case 3:e="status red",t="Racing";break;case 4:e="status green",t="Has Run";break;default:e="status",t="Unknown"}var i=0!==a.props.race.placings.first?a.props.race.placings.first:"",c=0!==a.props.race.placings.second?a.props.race.placings.second:"",r=0!==a.props.race.placings.third?a.props.race.placings.third:"";return i.constructor===Array&&(i=i.join(", ")),c.constructor===Array&&(c=c.join(", ")),r.constructor===Array&&(r=r.join(", ")),Object(v.jsxs)("div",{className:"race",children:[Object(v.jsxs)("div",{className:"details",children:[Object(v.jsx)("div",{className:"mb-5 bold",children:"Details"}),Object(v.jsx)("div",{className:"mb-5 name",children:a.props.race.name}),Object(v.jsx)("div",{className:"mb-5",children:a.props.race.time}),Object(v.jsx)("div",{className:"mb-5",children:a.props.race.distance}),Object(v.jsxs)("div",{children:[Object(v.jsx)("span",{className:"status-label",children:"Status:\xa0"}),Object(v.jsx)("span",{className:e,children:t})]})]}),Object(v.jsxs)("div",{className:"placings",children:[Object(v.jsx)("div",{className:"mb-5 bold",children:"Placings"}),Object(v.jsxs)("div",{className:"placing mb-5",children:[Object(v.jsx)("span",{className:"label bold gold",children:"1st"}),"\xa0",i]}),Object(v.jsxs)("div",{className:"placing mb-5",children:[Object(v.jsx)("span",{className:"label bold silver",children:"2nd"}),"\xa0",c]}),Object(v.jsxs)("div",{className:"placing",children:[Object(v.jsx)("span",{className:"label bold bronze",children:"3rd"}),"\xa0",r]})]}),Object(v.jsx)("div",{className:"tips-heading bold",children:"Tips"}),Object(v.jsx)("div",{className:"tips",children:n})]})}}]),s}(a.Component),z=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){for(var e,t=this,s=[],a=t.props.races.find((function(e){return e._id===t.props.selectedRace})),n=t.props.meetTips.filter((function(e){return e.raceId===t.props.selectedRace})),i=0,c=t.props.races.length;i<c;i++){switch(t.props.races[i].status){case 2:e="circle bg-orange";break;case 3:e="circle bg-red";break;case 4:e="circle bg-green";break;default:e="circle bg-blue"}t.props.races[i]._id===t.props.selectedRace&&(e+=" selected"),s.push(Object(v.jsx)("div",{id:t.props.races[i]._id,className:e,onClick:t.props.onClick,children:i+1},i))}return a?Object(v.jsxs)("div",{className:"race-meet",children:[Object(v.jsx)("div",{className:"race-selector",children:s}),Object(v.jsxs)("h3",{children:["RACE ",a.number]}),Object(v.jsx)(K,{race:a,meets:t.props.meets,selectedMeetId:this.props.selectedMeetId,punters:t.props.punters,user:t.props.user,tips:n})]}):Object(v.jsx)("div",{})}}]),s}(a.Component),Q=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){return Object(j.a)(this,s),t.apply(this,arguments)}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){var e=this,t=this.props.races.length?this.props.races.filter((function(t){return t.meetId===e.props.selectedMeet})):[],s=this.props.tips.length?this.props.tips.filter((function(t){return t.meetId===e.props.selectedMeet})):[];return t.sort((function(e,t){return e.number-t.number})),Object(v.jsxs)("div",{className:"app",children:[Object(v.jsx)(_,{page:"Results",path:this.props.path,competitions:this.props.competitions,user:this.props.user,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.props.handleCompetitionSelect,onReloadData:this.props.onReloadData,isAdmin:this.props.isAdmin,text:"This is where you can see the results of the hours of peoples research, strategy and rumination....before they just picked a number because they liked the jockey's pink star-spangled uniform."}),Object(v.jsx)(F,{meets:this.props.meets,selectedMeetId:this.props.selectedMeet,onChange:this.props.onMeetChange}),t&&s&&Object(v.jsx)(z,{races:t,selectedMeetId:this.props.selectedMeet,selectedRace:this.props.selectedRace,user:this.props.user,punters:this.props.punters,meets:this.props.meets,meetTips:s,onClick:this.props.onRaceChange}),!t.length&&Object(v.jsx)("div",{children:"This meet doesn't seem to have any races."}),Object(v.jsx)(q,{path:this.props.path})]})}}]),s}(a.Component);function V(e){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h4",{className:"lb-heading teal",children:"PODIUM"}),Object(v.jsxs)("div",{className:"podium",children:[Object(v.jsxs)("div",{className:"second",children:[Object(v.jsx)("img",{src:"pics/"+e.second.image,alt:"Profile pic",className:"pic"}),Object(v.jsxs)("span",{className:"name",children:[e.second.name.first," ",e.second.name.last]}),Object(v.jsxs)("div",{className:"bar",children:[Object(v.jsxs)("div",{className:"number",children:["2",Object(v.jsx)("sup",{children:"ND"})]}),Object(v.jsxs)("div",{className:"points",children:[e.points[1].points," PTS"]})]})]}),Object(v.jsxs)("div",{className:"first",children:[Object(v.jsx)("img",{src:"pics/"+e.first.image,alt:"Profile pic",className:"pic"}),Object(v.jsxs)("span",{className:"name",children:[e.first.name.first," ",e.first.name.last]}),Object(v.jsxs)("div",{className:"bar",children:[Object(v.jsx)("div",{className:"icon-trophy"}),Object(v.jsxs)("div",{className:"number",children:["1",Object(v.jsx)("sup",{children:"ST"})]}),Object(v.jsxs)("div",{className:"points",children:[e.points[0].points," PTS"]})]})]}),Object(v.jsxs)("div",{className:"third",children:[Object(v.jsx)("img",{src:"pics/"+e.third.image,alt:"Profile pic",className:"pic"}),Object(v.jsxs)("span",{className:"name",children:[e.third.name.first," ",e.third.name.last]}),Object(v.jsxs)("div",{className:"bar",children:[Object(v.jsxs)("div",{className:"number",children:["3",Object(v.jsx)("sup",{children:"RD"})]}),Object(v.jsxs)("div",{className:"points",children:[e.points[2].points," PTS"]})]})]})]})]})}var $=function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(){var e;Object(j.a)(this,s);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).findTips=function(t,s){return e.props.tips.find((function(e){return e.punterId===t&&e.raceId===s}))},e.findPunter=function(t){return e.props.punters.find((function(e){return e._id===t}))},e.findPuntersPoints=function(e,t){return e.find((function(e){return e.punterId===t}))},e.calculatePoints=function(){for(var t,s,a,n,i,c,r=[],o=e.props.punters.length,l=0,d=0,p=0;o--;)r.push({punterId:e.props.punters[o]._id,points:0,trifectas:0,quinellas:0,firsts:0,seconds:0,thirds:0});for(o=e.props.punters.length;o--;)for(t=e.props.races.length;t--;)if(n=e.props.races[t].placings,i=e.findTips(e.props.punters[o]._id,e.props.races[t]._id)){if(l=d=p=0,c=e.findPuntersPoints(r,e.props.punters[o]._id),n.first.constructor===Array)for(s=0,a=n.first.length;s<a;s++)i.selections.includes(n.first[s])&&(c.points+=3,3,c.firsts++,l++);else i.selections.includes(n.first)&&(c.points+=3,3,c.firsts++,l++);if(n.second.constructor===Array)for(s=0,a=n.second.length;s<a;s++)i.selections.includes(n.second[s])&&(c.points+=2,2,c.seconds++,d++);else i.selections.includes(n.second)&&(c.points+=2,2,c.seconds++,d++);if(n.third.constructor===Array)for(s=0,a=n.third.length;s<a;s++)i.selections.includes(n.third[s])&&(c.points+=1,1,c.thirds++,p++);else i.selections.includes(n.third)&&(c.points+=1,1,c.thirds++,p++);(1===l&&1===d&&1===p||2===l&&1===d||1===l&&2===d)&&c.trifectas++,(1===l&&1===d&&0===p||2===l&&0===d)&&c.quinellas++}return r},e}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(e===this.props)}},{key:"render",value:function(){for(var e,t,s,a,n,i,c,r=this,o=this.calculatePoints(),l=[],d=[],p=[],h=function(e,t){i=r.props.punters.find((function(t){return t._id===r.props.selectedCompetition.gameAccounts[e]})),l.push(i)},u=0,j=this.props.selectedCompetition.gameAccounts.length;u<j;u++)h(u);for(var m=function(e,t){c=o.find((function(t){return t.punterId===l[e]._id})),d.push(Object(v.jsxs)("div",{className:"total",children:[Object(v.jsx)("img",{src:"pics/"+l[e].image,alt:"Profile pic",className:"pic"}),Object(v.jsxs)("div",{className:"name",children:[l[e].name.first," ",l[e].name.last]}),Object(v.jsxs)("div",{className:"points",children:[c.points," PTS"]})]},e)),o.splice(o.indexOf(c),1)},b=0,f=l.length;b<f;b++)m(b);o.sort((function(e,t){return t.points-e.points||t.trifectas-e.trifectas||t.quinellas-e.quinellas||t.firsts-e.firsts||t.seconds-e.seconds})),e=this.findPunter(o[0].punterId),t=this.findPunter(o[1].punterId),s=this.findPunter(o[2].punterId);for(var O=0,g=o.length;O<g;O++)0!==O&&1!==O&&2!==O&&(a=this.findPunter(o[O].punterId),n=O+1!==11&&(O+1)%10===1?"<sup>ST</sup>":O+1!==12&&(O+1)%10===2?"<sup>ND</sup>":O+1!==13&&(O+1)%10===3?"<sup>RD</sup>":"<sup>TH</sup>",p.push(Object(v.jsxs)("div",{className:"loser",children:[Object(v.jsx)("span",{className:"number",dangerouslySetInnerHTML:{__html:O+1+n}}),Object(v.jsxs)("span",{className:"points",children:[o[O].points," PTS"]}),Object(v.jsx)("img",{src:"pics/"+a.image,alt:"Profile pic",className:"pic"}),Object(v.jsxs)("span",{className:"name",children:[a.name.first," ",a.name.last]})]},O)));return Object(v.jsxs)("div",{className:"app",children:[Object(v.jsx)(_,{page:"Leaderboard",path:this.props.path,competitions:this.props.competitions,user:this.props.user,selectedCompetition:this.props.selectedCompetition,handleCompetitionSelect:this.props.handleCompetitionSelect,onReloadData:this.props.onReloadData,isAdmin:this.props.isAdmin,text:"To the victors go the spoils, and to the losers....go home."}),!!d.length&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h4",{className:"lb-heading",children:"GAME ACCOUNTS"}),Object(v.jsx)("div",{className:"game-account-totals",children:d})]}),Object(v.jsx)(V,{first:e,second:t,third:s,points:o}),Object(v.jsx)("h4",{className:"lb-heading",children:"BEST OF THE REST"}),p,Object(v.jsx)(q,{path:this.props.path})]})}}]),s}(a.Component),X=(s(39),function(e){Object(f.a)(s,e);var t=Object(O.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).handleLogin=function(e){var t=a.state.allPunters.find((function(t){return t._id===e}));a.setState({authenticated:!0,user:t}),localStorage.setItem("user",e),a.getUserCompetitions(e)},a.handleCompetitionSelect=function(e){var t,s,n,i,c=null,r=null;if(e._id)t=e._id,s=e;else{t=e.target.value?e.target.value:e.target.getAttribute("data-value");for(var o=0,l=a.state.competitions.length;o<l;o++)if(t===a.state.competitions[o]._id.toString()){s=a.state.competitions[o];break}}for(n=0,i=a.state.meets.length;n<i;n++)if(a.state.meets[n].competitionId===s._id){c=a.state.meets[n]._id;break}for(n=0,i=a.state.races.length;n<i;n++)if(a.state.races[n].meetId===c&&1===a.state.races[n].number){r=a.state.races[n]._id;break}var d=s.admins.includes(a.state.user._id);a.setState({selectedCompetition:t,selectedMeet:c,selectedRace:r,isAdmin:d}),localStorage.setItem("selectedCompetitionId",t),localStorage.setItem("selectedMeet",c),localStorage.setItem("selectedRace",r),localStorage.setItem("isAdmin",d),a.setData(s,!0)},a.handleReloadData=function(e){var t=e.target.classList.contains("icon-reload")?e.target.parentElement:e.target;t.classList.add("loading"),a.setData(a.state.selectedCompetition,!1).then((function(){t.classList.remove("loading")}))},a.handleMeetSelect=function(e){for(var t,s=Object(u.a)(a.state.races),n=parseInt(e.target.value,10),i=0,c=s.length;i<c;i++)s[i].meetId===n&&1===s[i].number&&(t=s[i]._id);for(var r,o=Object(h.a)({},a.state.savedRaces),l=function(e,t){s[t].meetId===n&&(r=a.state.tips.find((function(e){return e.raceId===s[t]._id&&e.punterId===a.state.user._id})),o["race".concat(s[t].number)]=!!r&&3===r.selections.length)},d=0,p=s.length;d<p;d++)l(0,d);a.setState({selectedMeet:n,selectedRace:t,savedRaces:o}),localStorage.setItem("selectedMeet",e.target.value),localStorage.setItem("selectedRace",t)},a.handleRaceSelect=function(e){var t=parseInt(e.target.id,10);localStorage.setItem("selectedRace",t),a.setState({selectedRace:t})},a.handleTabSelect=function(e){a.setState({selectedTab:e})},a.handleSaveTips=function(e){var t=Object(b.a)(a);if(!t.useJSON){var s,n=Object(u.a)(t.state.tips);if(e.databaseId){for(var i=0,c=n.length;i<c;i++)if(n[i]._id===e.databaseId){s=n[i];break}s&&(s.selections=e.selections,fetch("".concat(t.backendURL,"/tips/").concat(e.databaseId),{method:"PUT",cache:"no-store",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({selections:s.selections})}).then((function(e){return e.ok?e.json():res.text().then((function(e){throw new Error(e)}))})).then((function(e){var t=Object(h.a)({},a.state.savedRaces),s=a.state.races.find((function(t){return t._id===e.raceId})).number;t["race".concat(s)]=3===e.selections.length,a.setState({savedRaces:t})})).catch((function(e){a.setData(a.state.selectedCompetition,!1),alert("There was an error saving a tip.  Try re-selecting it again.\nIf you keep getting the error, take a screenshot of this message and send it to your competition administrator.\n\n".concat(e))})),t.setState({tips:n}))}else{s={_id:k(8),competitionId:t.state.selectedCompetition._id,meetId:t.state.selectedMeet,raceId:null,punterId:t.state.user._id,selections:e.selections};for(var r=Object(u.a)(a.state.races),o=0,l=r.length;o<l;o++)if(r[o].meetId===a.state.selectedMeet&&r[o].number===e.number){s.raceId=r[o]._id;break}fetch("".concat(t.backendURL,"/tips"),{method:"POST",cache:"no-store",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){if(!e.ok)return res.text().then((function(e){throw new Error(e)}))})).catch((function(e){a.setData(a.state.selectedCompetition,!1),alert("There was an error saving a tip.  Try re-selecting it again.\nIf you keep getting the error, take a screenshot of this message and send it to your competition administrator.\n\n".concat(e))})),n.push(s),t.setState({tips:n})}}},a.handleSavePlacings=function(e,t){var s=Object(u.a)(a.state.races),n=s.find((function(t){return t._id===e})),i=s.indexOf(n);n.placings=t,s[i]=n,a.updateRace(e,s,n)},a.handleSaveStatus=function(e){var t=parseInt(e.target.getAttribute("data-race-id"),10),s=Object(u.a)(a.state.races),n=s.find((function(e){return e._id===t})),i=s.indexOf(n);n.status=parseInt(e.target.getAttribute("data-status"),10),s[i]=n,a.updateRace(t,s,n)},a.handleSaveScratchings=function(e,t){var s=Object(u.a)(a.state.races),n=s.find((function(t){return t._id===e})),i=s.indexOf(n);n.scratchings=t,s[i]=n,a.updateRace(e,s,n)},a.updateRace=function(e,t,s){a.useJSON||fetch("".concat(a.backendURL,"/races/").concat(e),{method:"PUT",cache:"no-store",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).catch((function(e){return console.error("Fetch error:",e)})),a.setState({races:t})},a.state={competitions:[],meets:[],races:[],punters:[],allPunters:[],tips:[],authenticated:null,user:null,isAdmin:!1,selectedCompetition:null,selectedMeet:null,selectedRace:null,selectedTab:1,appLoadFailed:!1,loadingData:!1,savedRaces:{race1:!1,race2:!1,race3:!1,race4:!1,race5:!1,race6:!1,race7:!1,race8:!1,race9:!1,race10:!1,race11:!1}},a.useJSON=!1,a.backendURL="https://spring-racing-tipping-88560.herokuapp.com",a.path="/",a}return Object(m.a)(s,[{key:"shouldComponentUpdate",value:function(e,t){return!(t===this.state)}},{key:"getAllPunters",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,s,a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(t=this).useJSON?"".concat(t.path,"mock/punters.json"):"".concat(t.backendURL,"/punters"),e.prev=2,t.setState({loadingData:!0}),e.next=6,fetch(s,{cache:"no-store",mode:"cors"});case 6:return a=e.sent,e.next=9,a.json();case 9:return n=e.sent,t.setState({allPunters:n,loadingData:!1}),e.abrupt("return","complete");case 14:return e.prev=14,e.t0=e.catch(2),console.log("An error occurred: "+e.t0),t.setState({loadingData:!1}),e.abrupt("return","fail");case 19:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"getCompetitionPunters",value:function(e){return this.state.allPunters.filter((function(t){return e.punters.includes(t._id)}))}},{key:"getUserCompetitions",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var s,a,n,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(s=this).useJSON?"".concat(s.path,"mock/competitions.json"):"".concat(s.backendURL,"/competitions/bypunter/").concat(t),e.prev=2,s.setState({loadingData:!0}),e.next=6,fetch(a,{cache:"no-store",mode:"cors"});case 6:return n=e.sent,e.next=9,n.json();case 9:return i=e.sent,s.setState({competitions:i,loadingData:!1}),e.abrupt("return","complete");case 14:return e.prev=14,e.t0=e.catch(2),console.log("An error occurred: "+e.t0),s.setState({loadingData:!1}),e.abrupt("return","fail");case 19:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setData",value:function(){var e=Object(p.a)(d.a.mark((function e(t,s){var a,n,i,c,r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=this).useJSON?"".concat(a.path,"mock/meets-").concat(t.startDate.split("-")[0],".json"):"".concat(a.backendURL,"/meets/bycompetition/").concat(t._id),i=a.useJSON?"".concat(a.path,"mock/races-").concat(t.startDate.split("-")[0],".json"):"".concat(a.backendURL,"/races/bycompetition/").concat(t._id),c=a.useJSON?"".concat(a.path,"mock/tips-").concat(t.startDate.split("-")[0],".json"):"".concat(a.backendURL,"/tips/bycompetition/").concat(t._id),e.prev=4,e.delegateYield(d.a.mark((function e(){var o,l,p,u,j,m,b,f,O,g,x,v,y,C,N;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s&&a.setState({loadingData:!0}),e.next=3,fetch(n,{cache:"no-store",mode:"cors"});case 3:return o=e.sent,e.next=6,o.json();case 6:return l=e.sent,e.next=9,fetch(i,{cache:"no-store",mode:"cors"});case 9:return p=e.sent,e.next=12,p.json();case 12:return u=e.sent,e.next=15,fetch(c,{cache:"no-store",mode:"cors"});case 15:return j=e.sent,e.next=18,j.json();case 18:if(m=e.sent,b=a.state.selectedMeet||parseInt(localStorage.getItem("selectedMeet"))||null,f=a.state.selectedRace||parseInt(localStorage.getItem("selectedRace"))||null,b||(b=l.length?l[0]._id:null,localStorage.setItem("selectedMeet",b)),!f)for(O=0,g=u.length;O<g;O++)u[O].meetId===b&&1===u[O].number&&(f=u[O]._id,localStorage.setItem("selectedRace",f));for(x=Object(h.a)({},r.state.savedRaces),y=function(e,t){u[e].meetId===b&&(v=m.find((function(t){return t.raceId===u[e]._id&&t.punterId===r.state.user._id})),x["race".concat(u[e].number)]=!!v&&3===v.selections.length)},C=0,N=u.length;C<N;C++)y(C);a.setState({meets:l,races:u,tips:m,punters:r.getCompetitionPunters(t),selectedCompetition:t,selectedMeet:b,selectedRace:f,savedRaces:x,loadingData:!1});case 27:case"end":return e.stop()}}),e)}))(),"t0",6);case 6:e.next=12;break;case 8:e.prev=8,e.t1=e.catch(4),console.log("An error occurred: "+e.t1),a.setState({loadingData:!1,appLoadFailed:!0});case 12:case"end":return e.stop()}}),e,this,[[4,8]])})));return function(t,s){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;if(setTimeout((function(){e.state.allPunters.length||e.setState({appLoadFailed:!0})}),3e4),localStorage.getItem("user")){var t=parseInt(localStorage.getItem("user"),10);this.setState({authenticated:!0,isAdmin:"true"===localStorage.getItem("isAdmin")}),this.getAllPunters().then((function(s){if("complete"===s){var a=e.state.allPunters.find((function(e){return e._id===t}));e.setState({user:a}),e.getUserCompetitions(t).then((function(t){if("complete"===t){var s=parseInt(localStorage.getItem("selectedCompetitionId"),10);if(s){for(var a,n=0,i=e.state.competitions.length;n<i;n++)s===e.state.competitions[n]._id&&(a=e.state.competitions[n]);e.setData(a,!0)}}}))}}))}else this.setState({authenticated:!1}),this.getAllPunters()}},{key:"render",value:function(){var e=this,t=window.location.href.split("/").slice(-1)[0];return this.state.loadingData||this.state.appLoadFailed||!(this.state.selectedCompetition&&this.state.punters.length||"login"===t&&this.state.allPunters.length||!1===this.state.authenticated)?this.state.appLoadFailed?Object(v.jsxs)("div",{className:"timeout-msg",children:[Object(v.jsx)("h2",{children:"Oh ohhh..."}),Object(v.jsx)("img",{src:"steve.gif",alt:"Steve Harvey - What's wrong withchu?"}),Object(v.jsx)("p",{children:"It seems like something has gone wrong with the database..."}),Object(v.jsx)("p",{children:"Curse you free Heroku account!"}),Object(v.jsx)("p",{children:"*shakes fist at the sky*"})]}):Object(v.jsxs)("div",{className:"loading-msg",children:[Object(v.jsx)("div",{className:"icon"}),Object(v.jsx)("div",{className:"text",children:"LOADING..."})]}):Object(v.jsx)(g.a,{children:Object(v.jsx)(N,{children:Object(v.jsx)(y,{children:Object(v.jsxs)(x.e,{children:[Object(v.jsx)(x.c,{exact:!0,path:this.path+"login",render:function(t){return e.state.selectedCompetition?Object(v.jsx)(x.b,{to:e.path+"results"}):Object(v.jsx)(U,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,allPunters:e.state.allPunters,handleLogin:e.handleLogin,handleCompetitionSelect:e.handleCompetitionSelect,authenticated:e.state.authenticated,user:e.state.user,isAdmin:e.state.isAdmin}))}}),Object(v.jsx)(x.c,{exact:!0,path:this.path+"admin",render:function(t){return e.state.authenticated&&e.state.selectedCompetition&&e.state.isAdmin?Object(v.jsx)(J,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,meets:e.state.meets,races:e.state.races,punters:e.state.punters,selectedCompetition:e.state.selectedCompetition,selectedMeet:e.state.selectedMeet,handleCompetitionSelect:e.handleCompetitionSelect,onReloadData:e.handleReloadData,onMeetChange:e.handleMeetSelect,onPlacingsChange:e.handleSavePlacings,onStatusChange:e.handleSaveStatus,onScratchingChange:e.handleSaveScratchings,user:e.state.user,isAdmin:e.state.isAdmin})):Object(v.jsx)(x.b,{to:e.path+"login"})}}),Object(v.jsx)(x.c,{exact:!0,path:this.path+"information",render:function(t){return e.state.authenticated&&e.state.selectedCompetition?Object(v.jsx)(B,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,punters:e.state.punters,selectedCompetition:e.state.selectedCompetition,handleCompetitionSelect:e.handleCompetitionSelect,onReloadData:e.handleReloadData,authenticated:e.state.authenticated,user:e.state.user,isAdmin:e.state.isAdmin})):Object(v.jsx)(x.b,{to:e.path+"login"})}}),Object(v.jsx)(x.c,{exact:!0,path:this.path+"statistics",render:function(t){return e.state.authenticated&&e.state.selectedCompetition?Object(v.jsx)(H,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,meets:e.state.meets,races:e.state.races,punters:e.state.punters,tips:e.state.tips,selectedCompetition:e.state.selectedCompetition,selectedTab:e.state.selectedTab,handleCompetitionSelect:e.handleCompetitionSelect,onTabSelect:e.handleTabSelect,onReloadData:e.handleReloadData,authenticated:e.state.authenticated,user:e.state.user,isAdmin:e.state.isAdmin})):Object(v.jsx)(x.b,{to:e.path+"login"})}}),Object(v.jsx)(x.c,{exact:!0,path:this.path+"tips",render:function(t){return e.state.authenticated&&e.state.selectedCompetition?Object(v.jsx)(G,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,meets:e.state.meets,races:e.state.races,tips:e.state.tips,punters:e.state.punters,selectedCompetition:e.state.selectedCompetition,selectedMeet:e.state.selectedMeet,selectedRace:e.state.selectedRace,handleCompetitionSelect:e.handleCompetitionSelect,onReloadData:e.handleReloadData,onMeetChange:e.handleMeetSelect,onSelectionChange:e.handleSaveTips,user:e.state.user,isAdmin:e.state.isAdmin,savedRaces:e.state.savedRaces})):Object(v.jsx)(x.b,{to:e.path+"login"})}}),Object(v.jsx)(x.c,{exact:!0,path:this.path+"results",render:function(t){return e.state.authenticated&&e.state.selectedCompetition?Object(v.jsx)(Q,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,meets:e.state.meets,races:e.state.races,punters:e.state.punters,tips:e.state.tips,selectedCompetition:e.state.selectedCompetition,selectedMeet:e.state.selectedMeet,selectedRace:e.state.selectedRace,handleCompetitionSelect:e.handleCompetitionSelect,onReloadData:e.handleReloadData,onMeetChange:e.handleMeetSelect,onRaceChange:e.handleRaceSelect,user:e.state.user,isAdmin:e.state.isAdmin})):Object(v.jsx)(x.b,{to:e.path+"login"})}}),Object(v.jsx)(x.c,{exact:!0,path:this.path+"leaderboard",render:function(t){return e.state.authenticated&&e.state.selectedCompetition?Object(v.jsx)($,Object(h.a)(Object(h.a)({},t),{},{path:e.path,competitions:e.state.competitions,meets:e.state.meets,races:e.state.races,punters:e.state.punters,tips:e.state.tips,user:e.state.user,selectedCompetition:e.state.selectedCompetition,handleCompetitionSelect:e.handleCompetitionSelect,onReloadData:e.handleReloadData,isAdmin:e.state.isAdmin})):Object(v.jsx)(x.b,{to:e.path+"login"})}}),Object(v.jsx)(x.b,{from:"/",to:this.path+"results"})]})})})})}}]),s}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s(40);o()(),c.a.render(Object(v.jsx)(X,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[41,1,2]]]);
//# sourceMappingURL=main.6f56111b.chunk.js.map